<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Public Key Cryptography </title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav>
    <ul>
      <li><a href="index.html">Home </a></li>
      <li><a href="1-principles.html">Principles</a></li>
      <li><a href="2-classical.html">Classical</a></li>
      <li><a href="3-math.html">Math</a></li>
      <li><a href="4-block.html">Block Ciphers</a></li>
      <li><a href="5-publickey.html" class="active">Public Key</a></li>
      <li><a href="6-hash.html">Hash & MACs</a></li>
      <li><a href="7-attacks.html">Attacks</a></li>
    </ul>
  </nav>

  <div class="container">
    <h1>Public Key Cryptography</h1>

    <!-- RSA Section -->
    <h2>RSA Algorithm</h2>
    <ol>
      <li>Choose primes p and q.</li>
      <li>Compute n = p×q and ϕ(n) = (p−1)(q−1).</li>
      <li>Choose e (public exponent) such that gcd(e,ϕ(n))=1.</li>
      <li>Compute d, the modular inverse of e mod ϕ(n).</li>
      <li>Public key = (e, n), Private key = (d, n).</li>
    </ol>

    <p><b>Encryption:</b> c = m^e mod n<br>
       <b>Decryption:</b> m = c^d mod n</p>

    <h2>Worked Example</h2>
    <p>p=5, q=11 → n=55, ϕ(n)=40.<br>
       Choose e=3 → d=27 (since 3×27 ≡ 1 mod 40).<br>
       Encrypt m=7: c=7^3 mod 55 = 13.<br>
       Decrypt: 13^27 mod 55 = 7.</p>

    <h2>Why RSA is Secure</h2>
    <p>Because factoring large n = p×q is infeasible for big primes.</p>

    <h2>Bad Design Example: SalCrypt</h2>
    <p>SalCrypt: c = m^e mod n, decryption uses inverse of e mod (n−1).  
    <b>Problem:</b> inverses can be found quickly, so scheme is insecure.</p>

    <!-- Diffie-Hellman Section -->
    <h2>Diffie-Hellman Key Exchange</h2>
    <p>First practical method (1976) for two parties to establish a shared secret over an insecure channel.</p>
    <ol>
      <li>Public parameters: prime p and base g.</li>
      <li>Alice chooses secret a → computes A = g^a mod p.</li>
      <li>Bob chooses secret b → computes B = g^b mod p.</li>
      <li>They exchange A and B.</li>
      <li>Shared key: K = B^a mod p = A^b mod p.</li>
    </ol>
    <p><b>Security:</b> Relies on the hardness of the <i>Discrete Log Problem</i>.  
    <b>Weakness:</b> vulnerable to Man-in-the-Middle if keys aren’t authenticated.</p>

    <!-- ElGamal Section -->
    <h2>ElGamal Encryption</h2>
    <p>Public-key encryption scheme (1985) built from Diffie-Hellman.</p>
    <ol>
      <li>Bob generates key pair: private b, public B = g^b mod p.</li>
      <li>Alice wants to send message P. She picks random a (ephemeral).</li>
      <li>Computes A = g^a mod p and K = B^a mod p.</li>
      <li>Ciphertext = (A, Enc<sub>K</sub>(P)) using symmetric encryption.</li>
      <li>Bob computes K = A^b mod p and decrypts.</li>
    </ol>
    <p><b>Security:</b> Based on the Discrete Log Problem, like Diffie-Hellman.</p>

    <!-- Hybrid Section -->
    <h2>Hybrid Encryption (Digital Envelope)</h2>
    <p>Combines Public-Key Encryption (PKE) and Symmetric Key Encryption (SKE) to get the best of both.</p>
    <ul>
      <li>Use PKE (RSA or ElGamal) to securely send a random symmetric key.</li>
      <li>Use that symmetric key (AES, DES, etc.) to encrypt large messages quickly.</li>
    </ul>
    <p><b>Used in practice:</b> HTTPS, TLS, PGP.</p>

    <!-- Practice Questions -->
    <h2>Practice Questions</h2>
    <ol>
      <li>
        What’s the main problem RSA security relies on?
        <button class="toggle-answer">Show Answer</button>
        <div class="answer" style="display:none;">Integer factorisation.</div>
      </li>
      <li>
        In RSA, what are the public and private keys?
        <button class="toggle-answer">Show Answer</button>
        <div class="answer" style="display:none;">Public = (e,n). Private = (d,n).</div>
      </li>
      <li>
        Why does SalCrypt fail as an encryption scheme?
        <button class="toggle-answer">Show Answer</button>
        <div class="answer" style="display:none;">Because modular inverses can be computed efficiently.</div>
      </li>
      <li>
        What security problem does Diffie-Hellman solve?
        <button class="toggle-answer">Show Answer</button>
        <div class="answer" style="display:none;">The key distribution problem (how to agree on a shared key).</div>
      </li>
      <li>
        How does ElGamal differ from RSA?
        <button class="toggle-answer">Show Answer</button>
        <div class="answer" style="display:none;">ElGamal is based on Diffie-Hellman (Discrete Log), RSA is based on Integer Factorisation.</div>
      </li>
      <li>
        Why is Hybrid Encryption used in practice?
        <button class="toggle-answer">Show Answer</button>
        <div class="answer" style="display:none;">Because it combines the security of PKE with the speed of SKE.</div>
      </li>
    </ol>
  </div>

  <script src="script.js"></script>
</body>
</html>
